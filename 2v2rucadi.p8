pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
player = 
{
	num=0;
	ammo=0;
	shieldtime=0; 
	hp=0; 
	x=0;
	y=0; 
	psx=2; 
	psy=0; 
	air=0; 
	jumping = 0; 
	t=0.0;
	sprite = 0;
}

p1 = player;
p2 = player;
p3 = player;
p4 = player;

val = 0
cx = 0
cy = 0
flag = 0
function solid(x, y)
	val=mget(x/8, y/8)
 	cx = x
	cy = y
	flag = fget(val, 1)--0 = terrain flag
	return flag
end


function checkcollision(x,y,w,h)

 return 
  solid(x-w,y-h) or
  solid(x+w,y-h) or
  solid(x-w,y+h) or
  solid(x+w,y+h)
end




function updatespeed(pl)

	--left
	dir = 0;
    if(btn(0, pl.num)) then
		dir = -1;
	end
	
	--right
	if(btn(1,pl.num)) then
		dir = 1;
	end
	
	if(dir == 0) then
		if(abs(pl.t)<0.11) then
			pl.t = 0 
		end
		
		if(pl.t != 0) then
			if(pl.t<0) then
				pl.t+=0.15;
			else 
				pl.t+=-0.15;
			end
		end	
		
	end

	if(dir == 1) then
		if(pl.t<0) then
			pl.t = pl.t + 0.1
		end
		pl.t = pl.t + 0.05;
		if (pl.t> 1) then
			pl.t = 1;
		end
	end
	
	if(dir == -1) then
		if(pl.t>0) then
			pl.t = pl.t - 0.1
		end
		
		pl.t = pl.t - 0.05;
		if(pl.t< -1) then
			pl.t = -1;
		end
	end
	
	pl.psx = pl.t * 3;
end



function updatePlayerSprite(pl)
	pl.x += pl.psx;
	if(pl.psx > 0) then 
		pl.sprite = (pl.sprite+1)%3; 
	elseif(pl.psx <0) then
		pl.sprite = (pl.sprite+1)%3;
		if(pl.sprite<3) then
			pl.sprite+=3;
		end
	end
end

function move(pl)
	updatespeed(pl)
	updatePlayerSprite(pl)
	--jump
	if(btn(2,pl.num)) then
		if(pl.air == 0 and pl.jumping==0) then
			pl.psy = 24;
			pl.jumping = 1;
			pl.air = 1;
		end
	end
	
	
	--y update

		if(pl.jumping==1) then
			pl.y -=4;
			pl.psy -=4;
			if(pl.psy == 0) then
				pl.jumping = 0
			end
		end

	if(not solid(pl.x, pl.y+9)) then	--8 + 1 of movement 		
		if(pl.jumping == 0) then
				pl.y +=2; --gravedad
		end
	else
		pl.air = 0;
	end
		
end
function _init()
	p1.num = 0;
	p1.x = 20;
	p1.y = 20;
end

function printplayer(pl)
	spr(16*pl.num+1 + pl.sprite,pl.x,pl.y)
end
function _update()
	move(p1);
end
function _draw()
	cls()

	mapdraw(0, 0, 0, 0, 32, 32)
	print(p1.psx)
	print(p1.sprite)

	printplayer(p1)
end

__gfx__
0000000007ccccc007ccccc007ccccc007ccccc007ccccc007ccccc0000000000000000000000000000000000000000000000000000000000000000000000000
000000007ccacacc7ccacacc7ccacacc7cacaccc7cacaccc7cacaccc000000000000000000000000000000000000000000000000000000000000000000000000
007007007ccacacd7ccacacd7ccacacd7cacaccd7cacaccd7cacaccd000000000000000000000000000000000000000000000000000000000000000000000000
00077000cccccccdcccccccdcccccccdcccccccdcccccccdcccccccd000000000000000000000000000000000000000000000000000000000000000000000000
000770000dccccd00dccccd00dccccd00dccccd00dccccd00dccccd0000000000000000000000000000000000000000000000000000000000000000000000000
0070070000dddd0000dddd0000dddd0000dddd0000dddd0000dddd00000000000000000000000000000000000000000000000000000000000000000000000000
0000000000d00d0000d00d0000d00d0000d00d0000d00d0000d00d00000000000000000000000000000000000000000000000000000000000000000000000000
0000000000d00d0000000d0000d0000000d00d0000000d0000d00000000000000000000000000000000000000000000000000000000000000000000000000000
555555550b3333300b3333300b3333300b3333300b3333300b333330000000000000000000000000000000000000000000000000000000000000000000000000
5ee66665b33a3a33b33a3a33b33a3a33b3a3a333b3a3a333b3a3a333000000000000000000000000000000000000000000000000000000000000000000000000
5e666665b33a3a31b33a3a31b33a3a31b3a3a331b3a3a331b3a3a331000000000000000000000000000000000000000000000000000000000000000000000000
56666665333333313333333133333331333333313333333133333331000000000000000000000000000000000000000000000000000000000000000000000000
56666665013333100133331001333310013333100133331001333310000000000000000000000000000000000000000000000000000000000000000000000000
56666665001111000011110000111100001111000011110000111100000000000000000000000000000000000000000000000000000000000000000000000000
56666665001001000010010000100100001001000010010000100100000000000000000000000000000000000000000000000000000000000000000000000000
55555555001001000000010000100000001001000000010000100000000000000000000000000000000000000000000000000000000000000000000000000000
0000000007aaaaa007aaaaa007aaaaa007aaaaa007aaaaa007aaaaa0000000000000000000000000000000000000000000000000000000000000000000000000
000000007aa8a8aa7aa8a8aa7aa8a8aa7a8a8aaa7a8a8aaa7a8a8aaa000000000000000000000000000000000000000000000000000000000000000000000000
000000007aa8a8a97aa8a8a97aa8a8a97a8a8aa97a8a8aa97a8a8aa9000000000000000000000000000000000000000000000000000000000000000000000000
00000000aaaaaaa9aaaaaaa9aaaaaaa9aaaaaaa9aaaaaaa9aaaaaaa9000000000000000000000000000000000000000000000000000000000000000000000000
0000000009aaaa9009aaaa9009aaaa9009aaaa9009aaaa9009aaaa90000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999000099990000999900009999000099990000999900000000000000000000000000000000000000000000000000000000000000000000000000
00000000009009000090090000900900009009000090090000900900000000000000000000000000000000000000000000000000000000000000000000000000
00000000009009000000090000900000009009000000090000900000000000000000000000000000000000000000000000000000000000000000000000000000
00000000076666600766666007666660076666600766666007666660000000000000000000000000000000000000000000000000000000000000000000000000
00000000766868667668686676686866768686667686866676868666000000000000000000000000000000000000000000000000000000000000000000000000
000000007668686d7668686d7668686d7686866d7686866d7686866d000000000000000000000000000000000000000000000000000000000000000000000000
000000006666666d6666666d6666666d6666666d6666666d6666666d000000000000000000000000000000000000000000000000000000000000000000000000
000000000d6666d00d6666d00d6666d00d6666d00d6666d00d6666d0000000000000000000000000000000000000000000000000000000000000000000000000
0000000000dddd0000dddd0000dddd0000dddd0000dddd0000dddd00000000000000000000000000000000000000000000000000000000000000000000000000
0000000000d00d0000d00d0000d00d0000d00d0000d00d0000d00d00000000000000000000000000000000000000000000000000000000000000000000000000
0000000000d00d0000000d0000d0000000d00d0000000d0000d00000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000006777777d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000006766666d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000d6ddddd50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000005dddddd50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000005dddddd50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000005dddddd50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010171717171717171717171710000006060610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010171717171717171717171710000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010171717171717171717170010000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010001717171717171010101010000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010000017171717171717171710000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010000000001717170000001710000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010101010101010101010101010000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010000017171717171700000017170000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010001717171717171717171717171700000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010000000171717000000000000171700000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0010000000171700000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0004040404040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
